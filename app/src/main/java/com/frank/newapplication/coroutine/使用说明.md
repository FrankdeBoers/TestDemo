# 协程性能监控使用说明

## 快速开始

1. **进入功能**：在MainActivity中点击"协程性能监控"按钮
2. **启动演示**：点击"启动性能监控演示"按钮
3. **查看结果**：点击"查看性能报告"按钮
4. **查看日志**：在Android Studio的Logcat中查看详细输出

## 功能说明

### 🎯 三种监控方案

1. **基础监控** (`CoroutinePerformanceInterceptor`)
   - 简单高效的协程性能监控
   - 记录执行时间、挂起次数、异常信息
   - 适合生产环境使用

2. **详细监控** (`CoroutinePerformanceHelper`)
   - 提供详细的性能统计和报告
   - 支持自定义协程名称
   - 单例模式，全局数据管理

3. **高级监控** (`AdvancedCoroutineInterceptor`)
   - 最全面的监控功能
   - 自动检测慢协程（>1秒）
   - 记录协程启动位置（堆栈跟踪）
   - 适合开发调试阶段

### 📊 监控指标

- **执行时间**：协程从启动到完成的总耗时
- **挂起次数**：协程在运行过程中的挂起次数
- **挂起时间**：每次挂起的总时长
- **异常信息**：协程执行过程中的异常详情
- **慢协程检测**：自动识别执行时间超过1秒的协程

### 🔍 查看日志

在Logcat中过滤以下标签查看详细输出：
- `CoroutinePerformance`：基础监控日志
- `CoroutinePerformanceHelper`：详细监控日志
- `AdvancedCoroutineInterceptor`：高级监控日志
- `FrankTest`：应用自定义日志

### 💡 使用建议

1. **开发阶段**：使用高级监控器进行详细分析
2. **测试阶段**：使用详细监控器进行性能测试
3. **生产环境**：使用基础监控器进行轻量级监控
4. **性能优化**：重点关注慢协程和异常协程

### 🚀 扩展使用

```kotlin
// 在您自己的代码中使用
val scope = CoroutineScope(CoroutinePerformanceInterceptor())
scope.launch {
    // 您的协程代码
}

// 或者使用辅助类
val helper = CoroutinePerformanceHelper.getInstance()
helper.launchWithPerformance("自定义名称") {
    // 您的协程代码
}
```

## 注意事项

- 监控代码本身会影响协程性能，建议在开发环境使用
- 大量协程时注意内存使用，定期清理统计数据
- 生产环境建议使用基础拦截器或完全关闭监控
- 堆栈跟踪功能会增加性能开销，谨慎使用 